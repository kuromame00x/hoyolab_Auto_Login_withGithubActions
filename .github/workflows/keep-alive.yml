name: Keep repos alive

on:
  schedule:
    - cron: '0 0 1 * *'   # UTCで毎月1日0:00
  workflow_dispatch:

jobs:
  ping:
    runs-on: ubuntu-latest
    steps:
      - name: Send repository_dispatch to target
        run: |
          curl -X POST \
            -H "Accept: application/vnd.github+json" \
            -H "Authorization: Bearer ${{ secrets.repository_dispatch }}" \
            -H "X-GitHub-Api-Version: 2022-11-28" \
            https://api.github.com/repos/${{ env.TARGET_OWNER }}/${{ env.TARGET_REPO }}/dispatches \
            -d '{"event_type":"keepalive"}'
        env:
          TARGET_OWNER: SashimiWithRice
          TARGET_REPO: hoyolab_Auto_Login_withGithubActions

      - name: Send repository_dispatch to keep-alive repo itself
        run: |
          curl -X POST \
            -H "Accept: application/vnd.github+json" \
            -H "Authorization: Bearer ${{ secrets.repository_dispatch }}" \
            -H "X-GitHub-Api-Version: 2022-11-28" \
            https://api.github.com/repos/${{ env.SELF_OWNER }}/${{ env.SELF_REPO }}/dispatches \
            -d '{"event_type":"self_keepalive"}'
        env:
          SELF_OWNER: SashimiWithRice
          SELF_REPO: activate_github_actions
.github/workflows/keep-alive.yml
